/*!
* BootstrapAutoComplete v1.5.0
* https://github.com/darrellwp/bootstrapautocomplete/
* Copyright 2025 Darrell Percey - Licensed under MIT
* https://github.com/darrellwp/bootstrapautocomplete/blob/main/LICENSE
*/
const defaults={maxDisplaySize:{value:10,type:"number"},data:{value:[],type:"object"},dataSource:{value:void 0,type:"function"},enterCallback:{value:void 0,type:"function"},clickCallback:{value:void 0,type:"function"},minimumTypeAhead:{value:1,type:"number"},overflow:{value:!1,type:"boolean"},maxHeight:{value:200,type:"number"},filterType:{value:"includes",type:"string"},zIndex:{value:10,type:"number"}};class BootstrapAutoComplete{constructor(e,t){if(!e||"INPUT"!=e.nodeName)throw new Error("No element or input type was found.");this.config={},this.element=e,this.filteredData=[],this.data=t?.data||[],this.menuIsShown=!1,this.setConfig(t),this.menu=this.buildSelectMenu(),this.addInputEvents(),e.bootstrapAutoComplete=this}setConfig(e){Object.keys(defaults).forEach((t=>{e&&e.hasOwnProperty(t)&&(typeof e[t]==defaults[t].type?"filterType"==t?["includes","startsWith","endsWith"].some((a=>a==e[t]))?this.config[t]=e[t]:console.error(`${t} must be type ${defaults[t].type} and be includes, startsWith, or endsWith. Used default values.`):this.config[t]=e[t]:console.error(`${t} must be type ${defaults[t].type}. Used default values.`)),this.config.hasOwnProperty(t)||(this.config[t]=defaults[t].value)}))}buildSelectMenu(){let e=window.getComputedStyle(this.element.parentElement,null),t=document.createElement("ul");return t.className="list-group position-absolute fade",t.style.width=`calc(100% - ${e.paddingLeft} - ${e.paddingRight}`,t.style.top="100%",t.style.zIndex=this.config.zIndex,this.config.overflow&&(t.classList.add("overflow-auto"),t.style.maxHeight=`${this.config.maxHeight}px`),this.element.parentElement.append(t),t}addInputEvents(){var e=this;this.element.addEventListener("keydown",(function(t){if(e.menuIsShown)switch(t.key){case"Enter":e.selectEntry(),t.preventDefault();break;case"ArrowUp":e.setActiveItem("previousElementSibling"),t.preventDefault();break;case"ArrowDown":e.setActiveItem("nextElementSibling"),t.preventDefault()}e.config.enterCallback&&"Enter"==t.key&&e.config.enterCallback(e.element.value)})),this.element.addEventListener("input",(async function(){if(null==e.config.dataSource&&0==e.config.data.length)throw new Error("No dataSource or data was provided");if(this.value.length<e.config.minimumTypeAhead)return e.hide();let t=this.value;if((!e.config.dataSource||(e.data=await e.config.dataSource(this.value,e.config.maxDisplaySize),null==e.data||Array.isArray(e.data)||(console.error(`The data returned was type ${typeof e.data}. Check that the dataSoruce is returning and array of strings. Data set to []`),e.data=[]),this.value==t))&&null!=e.data)if(e.filteredData=e.data.filter((t=>t.toLowerCase()[e.config.filterType](this.value.toLowerCase()))),e.menu.innerHTML="",e.filteredData.length>0){let t=e.buildRegex(this.value,e.config.filterType);e.filteredData.slice(0,e.config.maxDisplaySize).forEach((a=>{e.menu.append(e.generateMenuItem(a,t))})),e.show()}else e.hide()})),this.element.addEventListener("focusout",(function(t){e.hide()}))}buildRegex(e,t){let a="",i="i";switch(t){case"startsWith":a=`^${e}`;break;case"endsWith":a=`${e}$`;break;default:a=e,i+="g"}return new RegExp(a,i)}generateMenuItem(e,t){let a=document.createElement("li");a.className="list-group-item list-group-item-action px-3 py-1",a.dataset.value=e,a.innerHTML=e.replace(t,"<strong>$&</strong>"),a.style.cursor="default";var i=this;return a.addEventListener("mousedown",(function(e){e.stopPropagation(),this.classList.add("active"),i.element.value=this.dataset.value,i.hide(),i.config.clickCallback&&i.config.clickCallback(i.element.value)})),a}setActiveItem(e){if(0==this.menu.querySelectorAll(".list-group-item").length)return;let t=this.menu.querySelector(".active"),a=this.menu.querySelector(".list-group-item:"+("nextElementSibling"==e?"first-child":"last-child"));if(t){t.classList.remove("active"),a=t[e]||a}a.classList.add("active"),this.config.overflow&&a.scrollIntoView({block:"nearest",inline:"nearest"})}selectEntry(){let e=this.menu.querySelector(".active");this.menu.querySelectorAll(".list-group-item").length>0&&e&&(this.element.value=e.dataset.value),this.hide()}show(){this.menuIsShown=!0,this.menu.classList.add("show")}hide(){this.menuIsShown=!1,this.menu.classList.remove("show"),setTimeout((()=>{this.menu.innerHTML=""}),100)}}
