/*!
* BootstrapAutoComplete v1.2.0
* https://github.com/darrellwp/bootstrapautocomplete/
* Copyright 2024 Darrell Percey - Licensed under MIT
* https://github.com/darrellwp/bootstrapautocomplete/blob/main/LICENSE
*/ 
const defaults={maxDisplaySize:{value:10,type:"number"},data:{value:[],type:"object"},dataSource:{value:void 0,type:"function"},minType:{value:1,type:"number"},overflow:{value:!1,type:"boolean"},maxHeight:{value:200,type:"number"}};class BootstrapAutoComplete{constructor(e,t){if(!e||"INPUT"!=e.nodeName)throw Error("No element or input type was found.");this.config={},this.element=e,this.filteredData=[],this.data=t?.data||[],this.menuIsShown=!1,this.setConfig(t),this.menu=this.buildSelectMenu(),this.addInputEvents(),e.bootstrapAutoComplete=this}setConfig(e){Object.keys(defaults).forEach(t=>{e&&e.hasOwnProperty(t)&&(typeof e[t]==defaults[t].type?this.config[t]=e[t]:console.error(`${t} must be type ${defaults[t].type}. Used default values.`)),this.config.hasOwnProperty(t)||(this.config[t]=defaults[t].value)})}buildSelectMenu(){let e=window.getComputedStyle(this.element.parentElement,null),t=document.createElement("ul");return t.className="list-group position-absolute top-100 fade",t.style.width=`calc(100% - ${e.paddingLeft} - ${e.paddingRight}`,this.config.overflow&&(t.classList.add("overflow-auto"),t.style.maxHeight=`${this.config.maxHeight}px`),this.element.parentElement.append(t),t}addInputEvents(){var e=this;this.element.addEventListener("keydown",function(t){if(e.menuIsShown)switch(t.key){case"Enter":e.selectEntry(),t.preventDefault();break;case"ArrowUp":e.setActiveItem("previousElementSibling"),t.preventDefault();break;case"ArrowDown":e.setActiveItem("nextElementSibling"),t.preventDefault()}}),this.element.addEventListener("input",async function(){if(void 0==e.config.dataSource&&0==e.config.data.length)throw Error("No dataSource or data was provided");if(this.value.length<e.config.minType)return e.hide();let t=this.value;if(!e.config.dataSource||(e.data=await e.config.dataSource(this.value,e.config.maxDisplaySize),this.value==t)){if(e.filteredData=e.data.filter(e=>e.toLowerCase().includes(this.value.toLowerCase())),e.menu.innerHTML="",e.filteredData.length>0){var i=RegExp(this.value,"gi");e.filteredData.slice(0,e.config.maxDisplaySize).forEach(t=>{e.menu.append(e.generateMenuItem(t,this.value,i))}),e.show()}else e.hide()}}),this.element.addEventListener("focusout",function(t){e.hide()})}generateMenuItem(e,t){let i=document.createElement("li");i.className="list-group-item list-group-item-action px-3 py-1",i.dataset.value=e,i.innerHTML=e.replaceAll(t,"<strong>$&</strong>");var a=this;return i.addEventListener("mousedown",function(e){e.stopPropagation(),this.classList.add("active"),a.element.value=this.dataset.value,a.hide()}),i}setActiveItem(e){if(0==this.menu.querySelectorAll(".list-group-item").length)return;let t=this.menu.querySelector(".active"),i=this.menu.querySelector(`.list-group-item:${"nextElementSibling"==e?"first-child":"last-child"}`);if(t){t.classList.remove("active");i=t[e]||i}i.classList.add("active"),this.config.overflow&&i.scrollIntoView()}selectEntry(){let e=this.menu.querySelector(".active");0!=this.menu.querySelectorAll(".list-group-item").length&&e&&(this.element.value=e.dataset.value,this.hide())}show(){this.menuIsShown=!0,this.menu.classList.add("show")}hide(){this.menuIsShown=!1,this.menu.classList.remove("show"),setTimeout(()=>{this.menu.innerHTML=""},100)}}