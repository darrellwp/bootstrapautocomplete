const defaults={serverProcessing:{value:!1,type:"boolean"},maxDisplaySize:{value:10,type:"number"},dataSource:{value:void 0,type:"function"},minType:{value:1,type:"number"}};class BootstrapAutoComplete{constructor(e,t){if(!e||"INPUT"!=e.nodeName)throw new Error("No element or input type was found.");if(this.config={},this.element=e,this.data=[],this.filteredData=[],this.menu=this.buildSelectMenu(),this.menuIsShown=!1,this.setConfig(t),null==this.config.dataSource)throw new Error("No dataSource was provided");this.config.serverProcessing||(this.data=this.config.dataSource().map(e=>e.toString())),this.addInputEvents(),e.bootstrapAutoComplete=this}setConfig(e){Object.keys(defaults).forEach(t=>{e&&e.hasOwnProperty(t)&&(typeof e[t]==defaults[t].type?this.config[t]=e[t]:console.error(`${t} must be type ${defaults[t].type}. Used default values.`)),this.config.hasOwnProperty(t)||(this.config[t]=defaults[t].value)})}buildSelectMenu(){let e=window.getComputedStyle(this.element.parentElement,null),t=document.createElement("ul");return t.className="list-group position-absolute top-100 fade",t.style.width=`calc(100% - ${e.paddingLeft} - ${e.paddingRight}`,this.element.parentElement.append(t),t}addInputEvents(){var e=this;this.element.addEventListener("keydown",function(t){if(e.menuIsShown)switch(t.key){case"Enter":e.selectEntry(),t.preventDefault();break;case"ArrowUp":e.setActivePrevious(),t.preventDefault();break;case"ArrowDown":e.setActiveNext(),t.preventDefault()}}),this.element.addEventListener("input",async function(){this.value.length>=e.config.minType?(e.config.serverProcessing&&(e.data=await e.config.dataSource(this.value,e.config.maxDisplaySize)),e.filteredData=e.data.filter(e=>e.includes(this.value)),e.menu.innerHTML="",e.filteredData.length>0?(e.filteredData.slice(0,e.config.maxDisplaySize).forEach(t=>{e.menu.append(e.generateMenuItem(t,this.value))}),e.menu.append(),e.show()):e.hide()):e.hide()}),this.element.addEventListener("focusout",function(t){e.hide()})}generateMenuItem(e,t){let i=document.createElement("li");i.className="list-group-item list-group-item-action px-3 py-1",i.dataset.value=e,i.innerHTML=e.replace(t,`<strong>${t}</strong>`);var s=this;return i.addEventListener("mousedown",function(e){e.preventDefault(),e.stopPropagation(),this.classList.add("active"),s.element.value=this.dataset.value,s.hide()}),i}setActiveNext(){if(0==this.menu.querySelectorAll(".list-group-item").length)return;let e=this.menu.querySelector(".active"),t=this.menu.querySelector(".list-group-item:first-child");if(e){e.classList.remove("active");let i=e.nextElementSibling;t=i||t}t.classList.add("active")}setActivePrevious(){if(0==this.menu.querySelectorAll(".list-group-item").length)return;let e=this.menu.querySelector(".active"),t=this.menu.querySelector(".list-group-item:last-child");if(e){e.classList.remove("active");let i=e.previousElementSibling;t=i||t}t.classList.add("active")}selectEntry(){let e=this.menu.querySelector(".active");0!=this.menu.querySelectorAll(".list-group-item").length&&e&&(this.element.value=e.dataset.value,this.hide())}show(){this.menuIsShown=!0,this.menu.classList.add("show")}hide(){this.menuIsShown=!1,this.menu.classList.remove("d-none"),this.menu.innerHTML=""}}